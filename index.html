<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: url('image.jpg') no-repeat center center fixed; /* 背景画像のURLを設定 */
      background-size: cover;
    }

    canvas {
      display: block;
    }

    #timer {
      position: absolute;
      top: 20px;
      right: 10px;
      font-size: 36px;
      color: rgb(94, 145, 246); /* タイマーの色を青に変更 */
    }
  </style>
  <title>保罗的第一次旅程</title>
</head>
<body>
  <canvas id="gameCanvas" width="2000" height="1000"></canvas>
    <!-- チリン音声ファイルを追加 -->
  <audio id="chimeAudio" src="chime.mp3"></audio>
    <!-- ラッパの音声ファイルを追加 -->
  <audio id="fanfareAudio" src="fanfare.mp3"></audio>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const chimeAudio = document.getElementById('chimeAudio');
    const fanfareAudio = document.getElementById('fanfareAudio');

    let playerX = 1820;
    let playerY = 360;
    const goalX = 2000;
    const goalY = 350;
    const checkpoints = [
      { x: 1770, y: 380, number:"       安提阿", passed: false },
      { x: 1650, y: 450, number:"萨拉米斯", passed: false },
      { x: 1520, y: 480, number:"帕福斯", passed: false },
      { x: 1405, y: 350, number:"佩尔吉", passed: false },
      { x: 1410, y: 300, number:"安提阿", passed: false },
      { x: 1500, y: 310, number:"以哥念", passed: false },
      { x: 1475, y: 330, number:"路司得", passed: false },
      { x: 1570, y: 350, number:"特庇", passed: false },
      { x: 1380, y: 360, number:"亚大利", passed: false },
      { x: 1780, y: 400, number:"塞琉西亚", passed: false },
    ];

    let currentCheckpoint = 0;
    let timerSeconds = 0;
    let timerInterval;

    function drawCheckpoints() {
      checkpoints.forEach((point) => {
        ctx.fillStyle = point.passed ? "#AEEEEE" : "#ADFF2F"; /* 薄い黄緑に変更 */
        ctx.fillRect(point.x, point.y, 30, 30);
        ctx.fillStyle = "blue";
        ctx.font = "16px Arial";
        ctx.fillText(point.number, point.x + 10, point.y + 20);
      });
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw checkpoints
      drawCheckpoints();

      // Draw goal
      ctx.fillStyle = "#ffa3a3";
      ctx.fillRect(goalX, goalY, 30, 30);

      // Draw player
      ctx.fillStyle = "#87CEEB"; /* 薄い水色に変更 */
      ctx.fillRect(playerX, playerY, 30, 30);

      // Check if the player has passed the next checkpoint
      if (!checkpoints[currentCheckpoint].passed &&
          playerX < checkpoints[currentCheckpoint].x + 50 &&
          playerX + 50 > checkpoints[currentCheckpoint].x &&
          playerY < checkpoints[currentCheckpoint].y + 50 &&
          playerY + 50 > checkpoints[currentCheckpoint].y) {
        checkpoints[currentCheckpoint].passed = true;
        currentCheckpoint++;
        playChimeSound();

        // Check if all checkpoints have been passed
        if (currentCheckpoint === checkpoints.length) {
          clearInterval(timerInterval);
          playFanfareSound();
          alert("真辛苦了！欢迎你回来！\nTime: " + timerSeconds + "秒");
          resetGame();
        }
      }

      // Check if the player has reached the goal
      if (playerX < goalX + 50 && playerX + 50 > goalX && playerY < goalY + 50 && playerY + 50 > goalY) {
        clearInterval(timerInterval);
        playFanfareSound();
        alert("真辛苦了！欢迎你回来！\nTime: " + timerSeconds + "秒");
        resetGame();
      }

      // Draw timer
      updateTimer();

      requestAnimationFrame(gameLoop);
    }

    function resetGame() {
      playerX = 1820;
      playerY = 360;
      currentCheckpoint = 0;
      checkpoints.forEach((point) => {
        point.passed = false;
      });
      timerSeconds = 0;
      updateTimer();
    }

    function updateTimer() {
      ctx.clearRect(canvas.width - 150, 0, 150, 50); // 修正：タイマーの領域をクリアするように変更
      ctx.fillStyle = "blue"; /* タイマーの色を青に変更 */
      ctx.font = "24px Arial";
      ctx.fillText("保罗的第一次旅程         "+"Time: " + timerSeconds/100, canvas.width - 500, 30); // 修正：タイマーの位置を調整
      timerSeconds++;
    }
    function playChimeSound() {
            // チリン音を再生
            chimeAudio.play();
        }

    function playFanfareSound() {
            // ラッパの音を再生
            fanfareAudio.play();
        }

    window.addEventListener("keydown", (e) => {
      switch (e.key) {
        case "ArrowUp":
          playerY -= 10;
          break;
        case "ArrowDown":
          playerY += 10;
          break;
        case "ArrowLeft":
          playerX -= 10;
          break;
        case "ArrowRight":
          playerX += 10;
          break;
      }
    });

    timerInterval = setInterval(() => {
      updateTimer();
    }, 1000);

    gameLoop();
  </script>
</body>
</html>
